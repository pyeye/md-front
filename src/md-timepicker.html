<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-input/iron-input.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">

<dom-module id="md-timepicker">
  <template>

    <style>
      :host {
        display: inline-block;
      }

      :host([hidden]) {
        display: none !important;
      }

      input[is="iron-input"] {
        font: inherit;
        outline: none;
        box-shadow: none;
        border: none;
        width: auto;
        text-align: center;
        background-color: #272727;
        color: #FFFFFF;
      }

      .container {
        @apply(--layout-horizontal);
      }

    </style>

    <div class="container">

      <input is="iron-input" class="hours" type="number" max=23 min=00 bind-value="{{_hours}}" aria-label="Hours">
      :
      <input is="iron-input" class="minutes" type="number" max=59 min=00 bind-value="{{_minutes}}" aria-label="Minutes">

    </div>

  </template>
</dom-module>

<script>
  Polymer({
    is: 'md-timepicker',

    properties: {
      value: {
        notify: true,
        type: String
      },

      _hours: {
        type: String,
        value: function() {
          var h = new Date().getHours();
          return h < 10 ? '0' + h : h;
        },
      },

      _minutes: {
        type: String,
        value: function() {
          var m = new Date().getMinutes();
          return m < 10 ? '0' + m : m;
        },
      },

    },

    observers: [
      '_hoursChanged(_hours)',
      '_minutesChanged(_minutes)',
      '_computeValue(_hours, _minutes)',
    ],

    //а здесь я хожу по охуеть какому тонкому льду ибо можно легко получить бесконечный цикл
    _hoursChanged: function(newVal, oldVal) {
      if (newVal.length === 1) {
        this._hours = '0' + newVal;
      }
    },

    _minutesChanged: function(newVal, oldVal) {
      if (newVal.length === 1) {
        this._minutes = '0' + newVal;
      }
    },

    _computeValue: function(hours, minutes) {
      this.value = hours + ':' + minutes + ':00';
    }
  });
</script>
